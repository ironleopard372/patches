From a5500d15029e2f386ccc9bbad12f475257ac337e Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <natechancellor@gmail.com>
Date: Fri, 13 Mar 2020 22:30:14 -0700
Subject: [PATCH 27/27] mm/sparse.c: Improper fix for unused functions

Link: https://lore.kernel.org/lkml/20200314003507.GN27711@MiWiFi-R3L-srv/
Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
---
 mm/sparse.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/mm/sparse.c b/mm/sparse.c
index bb99633575b5..97c3b4f2bd7a 100644
--- a/mm/sparse.c
+++ b/mm/sparse.c
@@ -245,6 +245,7 @@ void __init subsection_map_init(unsigned long pfn, unsigned long nr_pages)
 	}
 }
 
+#ifdef CONFIG_MEMORY_HOTPLUG
 static int clear_subsection_map(unsigned long pfn, unsigned long nr_pages)
 {
 	DECLARE_BITMAP(map, SUBSECTIONS_PER_SECTION) = { 0 };
@@ -293,11 +294,13 @@ static int fill_subsection_map(unsigned long pfn, unsigned long nr_pages)
 
 	return rc;
 }
+#endif
 #else
 void __init subsection_map_init(unsigned long pfn, unsigned long nr_pages)
 {
 }
 
+#ifdef CONFIG_MEMORY_HOTPLUG
 static int clear_subsection_map(unsigned long pfn, unsigned long nr_pages)
 {
 	return 0;
@@ -313,6 +316,7 @@ static int fill_subsection_map(unsigned long pfn, unsigned long nr_pages)
 	return 0;
 }
 #endif
+#endif
 
 /* Record a memory area against a node. */
 void __init memory_present(int nid, unsigned long start, unsigned long end)
-- 
2.26.0.rc1

