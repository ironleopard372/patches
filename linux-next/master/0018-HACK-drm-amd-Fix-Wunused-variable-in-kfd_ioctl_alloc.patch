From 89a11fdca7ae86de967b18787fb74713c650af1b Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <nathan@kernel.org>
Date: Fri, 10 Sep 2021 13:49:42 -0700
Subject: [PATCH 18/18] HACK: drm/amd: Fix -Wunused-variable in
 kfd_ioctl_alloc_memory_of_gpu()

Signed-off-by: Nathan Chancellor <nathan@kernel.org>
---
 drivers/gpu/drm/amd/amdkfd/kfd_chardev.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c b/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c
index 4de907f3e66a..fa2c76416735 100644
--- a/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c
+++ b/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c
@@ -1251,7 +1251,9 @@ static int kfd_ioctl_alloc_memory_of_gpu(struct file *filep,
 	struct kfd_process_device *pdd;
 	void *mem;
 	struct kfd_dev *dev;
+#if IS_ENABLED(CONFIG_HSA_AMD_SVM)
 	struct svm_range_list *svms = &p->svms;
+#endif
 	int idr_handle;
 	long err;
 	uint64_t offset = args->mmap_offset;
-- 
2.33.0

