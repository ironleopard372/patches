From 2e57165cc468853aac087c4982e87fcc2a49d2e2 Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <natechancellor@gmail.com>
Date: Tue, 16 Jun 2020 21:01:26 -0700
Subject: [PATCH 16/17] riscv: vdso: Apply Fangrui's suggestion

Link: https://lore.kernel.org/linux-riscv/CAFP8O3Kf54SYBKMTQDhJ+UwTate7KDszSGG1MwPJc0kTFhqkWw@mail.gmail.com/
Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
---
 arch/riscv/kernel/vdso/Makefile | 1 +
 1 file changed, 1 insertion(+)

diff --git a/arch/riscv/kernel/vdso/Makefile b/arch/riscv/kernel/vdso/Makefile
index 02ed0adbcebd..c51f56bde305 100644
--- a/arch/riscv/kernel/vdso/Makefile
+++ b/arch/riscv/kernel/vdso/Makefile
@@ -66,6 +66,7 @@ quiet_cmd_vdsold = VDSOLD  $@
                            -Wl,-T,$(filter-out FORCE,$^) -o $@.tmp && \
                    $(CROSS_COMPILE)objcopy \
                            $(patsubst %, -G __vdso_%, $(vdso-syms)) $@.tmp $@ && \
+                   printf '\1' | dd of=$@ conv=notrunc bs=1 seek=16 status=none && \
                    rm $@.tmp
 
 # install commands for the unstripped file
-- 
2.27.0

