From fc61f54ba12cd8d72f425fd894195d49014b05f0 Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <nathan@kernel.org>
Date: Thu, 17 Jun 2021 17:49:30 -0700
Subject: [PATCH 13/13] next-20210617 hacks

Signed-off-by: Nathan Chancellor <nathan@kernel.org>
---
 drivers/scsi/elx/Kconfig | 2 ++
 mm/zbud.c                | 4 ++--
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/scsi/elx/Kconfig b/drivers/scsi/elx/Kconfig
index 831daea7a951..a54f0344fd5e 100644
--- a/drivers/scsi/elx/Kconfig
+++ b/drivers/scsi/elx/Kconfig
@@ -3,6 +3,8 @@ config SCSI_EFCT
 	depends on PCI && SCSI
 	depends on TARGET_CORE
 	depends on SCSI_FC_ATTRS
+	# https://lore.kernel.org/r/YMvpc5KsGYFSAjok@archlinux-ax161/
+	depends on !ARM || (ARM && !CPU_V6)
 	select CRC_T10DIF
 	help
 	  The efct driver provides enhanced SCSI Target Mode
diff --git a/mm/zbud.c b/mm/zbud.c
index 3f61304405cb..a78ba8240b3d 100644
--- a/mm/zbud.c
+++ b/mm/zbud.c
@@ -208,6 +208,8 @@ static int num_free_chunks(struct zbud_header *zhdr)
 	return NCHUNKS - zhdr->first_chunks - zhdr->last_chunks;
 }
 
+#ifdef CONFIG_ZPOOL
+
 /*****************
  * API Functions
 *****************/
@@ -526,8 +528,6 @@ static u64 zbud_get_pool_size(struct zbud_pool *pool)
  * zpool
  ****************/
 
-#ifdef CONFIG_ZPOOL
-
 static int zbud_zpool_evict(struct zbud_pool *pool, unsigned long handle)
 {
 	if (pool->zpool && pool->zpool_ops && pool->zpool_ops->evict)
-- 
2.32.0.93.g670b81a890

