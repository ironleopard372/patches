From 95e6e50596699becd75e79eafa4a6a336748945c Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <natechancellor@gmail.com>
Date: Tue, 26 May 2020 21:16:45 -0700
Subject: [PATCH 14/32] drm/msm: Use 64-bit division helper in
 _dpu_core_perf_crtc_update_bus

Link: https://lore.kernel.org/lkml/20200527041618.GA3137030@ubuntu-s3-xlarge-x86/
Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
---
 drivers/gpu/drm/msm/disp/dpu1/dpu_core_perf.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/msm/disp/dpu1/dpu_core_perf.c b/drivers/gpu/drm/msm/disp/dpu1/dpu_core_perf.c
index 85c2a4190840..5ea725d8da6c 100644
--- a/drivers/gpu/drm/msm/disp/dpu1/dpu_core_perf.c
+++ b/drivers/gpu/drm/msm/disp/dpu1/dpu_core_perf.c
@@ -250,7 +250,7 @@ static int _dpu_core_perf_crtc_update_bus(struct dpu_kms *kms,
 
 	for (i = 0; i < kms->num_paths; i++)
 		icc_set_bw(kms->path[i],
-			Bps_to_icc(avg_bw), (perf.max_per_pipe_ib));
+			div_u64(avg_bw, 1000), (perf.max_per_pipe_ib));
 
 	return ret;
 }
-- 
2.27.0.rc0

