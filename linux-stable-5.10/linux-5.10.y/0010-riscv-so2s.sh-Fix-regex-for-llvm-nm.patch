From a05e9c2a7d5d7c523fa16a32884fdb3947f7b040 Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <natechancellor@gmail.com>
Date: Sat, 23 Jan 2021 12:08:08 -0700
Subject: [PATCH 10/10] riscv: so2s.sh: Fix regex for llvm-nm

Link: https://github.com/ClangBuiltLinux/linux/issues/1266
Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
---
 arch/riscv/kernel/vdso/so2s.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/riscv/kernel/vdso/so2s.sh b/arch/riscv/kernel/vdso/so2s.sh
index e64cb6d9440e..04182cf3a991 100755
--- a/arch/riscv/kernel/vdso/so2s.sh
+++ b/arch/riscv/kernel/vdso/so2s.sh
@@ -2,5 +2,5 @@
 # SPDX-License-Identifier: GPL-2.0+
 # Copyright 2020 Palmer Dabbelt <palmerdabbelt@google.com>
 
-sed 's!\([0-9a-f]*\) T \([a-z0-9_]*\)\(@@LINUX_4.15\)*!.global \2\n.set \2,0x\1!' \
+sed 's!\([0-9a-f]*\) T \([a-z0-9_]*\)\(@@\?LINUX_4.15\)*!.global \2\n.set \2,0x\1!' \
 | grep '^\.'
-- 
2.30.0

