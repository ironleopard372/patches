From 23b0d41ed2a17e4ce2d1d25c2937060ef3f79f54 Mon Sep 17 00:00:00 2001
From: Nathan Chancellor <natechancellor@gmail.com>
Date: Wed, 3 Oct 2018 14:39:42 -0700
Subject: [PATCH 08/13] DO-NOT-UPSTREAM: Hide -Wconstant-conversion behind W=3

There are a few of these warnings sprinkled throughout the kernel and
there is some pushback on fixing them. Joe Perches suggested that this
be hidden behind W=3 like all of the other signed warnings. This is also
disabled in Chrome OS's 4.14 branch.

Link: https://lore.kernel.org/lkml/20180619192504.180479-1-mka@chromium.org/
Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
---
 Makefile                   | 1 +
 scripts/Makefile.extrawarn | 1 +
 2 files changed, 2 insertions(+)

diff --git a/Makefile b/Makefile
index c99bb787f7ae..0f08362d67bb 100644
--- a/Makefile
+++ b/Makefile
@@ -712,6 +712,7 @@ KBUILD_CFLAGS += $(call cc-disable-warning, tautological-compare)
 KBUILD_CFLAGS += $(call cc-disable-warning, duplicate-decl-specifier)
 KBUILD_CFLAGS += $(call cc-disable-warning, empty-body)
 KBUILD_CFLAGS += $(call cc-disable-warning, switch)
+KBUILD_CFLAGS += $(call cc-disable-warning, constant-conversion)
 # CLANG uses a _MergedGlobals as optimization, but this breaks modpost, as the
 # source of a reference will be _MergedGlobals and not on of the whitelisted names.
 # See modpost pattern 2
diff --git a/scripts/Makefile.extrawarn b/scripts/Makefile.extrawarn
index 9bd19cec7b56..5ad36ada4f10 100644
--- a/scripts/Makefile.extrawarn
+++ b/scripts/Makefile.extrawarn
@@ -47,6 +47,7 @@ warning-2 += $(call cc-option, -Wunused-macros)
 warning-3 := -Wbad-function-cast
 warning-3 += -Wcast-qual
 warning-3 += -Wconversion
+warning-3 += $(call cc-option, -Wconstant-conversion)
 warning-3 += -Wpacked
 warning-3 += -Wpadded
 warning-3 += -Wpointer-arith
-- 
2.19.0

